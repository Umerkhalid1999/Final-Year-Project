<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}DataLab: AI-Driven Data Preprocessing{% endblock %}</title>
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Custom CSS -->
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
    <!-- Font Awesome for icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">

    <!-- Critical Sidebar Fix - Applied to ensure proper styling regardless of CSS loading order -->
    <style>
        /* Direct sidebar fix that will override any other styles */
        .sidebar {
            background-color: #1F2937 !important;
            color: white !important;
        }

        /* Fix for the sidebar elements in Image 1 */
        body > div > div > a,
        body > div > div > i,
        body > div > nav > a,
        body > div > nav > i,
        body > nav > a,
        body > nav > i,
        div.sidebar > a,
        div.sidebar > i,
        .sidebar > a,
        .sidebar > i,
        .sidebar svg,
        nav.sidebar > a,
        nav.sidebar > i {
            color: white !important;
            background-color: transparent !important;
        }

        /* Fix for sidebar content */
        .sidebar h2,
        .sidebar .sidebar-header h2,
        .sidebar .sidebar-header i {
            color: white !important;
        }

        /* Fix for nav items */
        .sidebar a,
        .sidebar .nav-item a {
            color: #D1D5DB !important;
        }

        .sidebar a:hover,
        .sidebar .nav-item a:hover,
        .sidebar .nav-item.active a {
            color: white !important;
            background-color: rgba(255, 255, 255, 0.1);
        }

        /* Fix for nav item icons */
        .sidebar .nav-item a i,
        .sidebar a i {
            color: #D1D5DB !important;
        }

        .sidebar .nav-item a:hover i,
        .sidebar a:hover i,
        .sidebar .nav-item.active a i {
            color: white !important;
        }
    </style>

    {% block head %}{% endblock %}
</head>
<body>
    <div class="container-fluid">
        {% block content %}{% endblock %}
    </div>

    <!-- Bootstrap JS Bundle with Popper -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
    <!-- Optional: jQuery -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

    <!-- Firebase SDK v9 with Modular API -->
    <script type="module">
        // Import the functions you need from the SDKs
        import { initializeApp } from "https://www.gstatic.com/firebasejs/9.22.1/firebase-app.js";
        import { getAuth, createUserWithEmailAndPassword, signInWithEmailAndPassword,
                 sendEmailVerification, sendPasswordResetEmail, confirmPasswordReset,
                 signOut, onAuthStateChanged, setPersistence,
                 browserLocalPersistence, browserSessionPersistence, updateProfile }
        from "https://www.gstatic.com/firebasejs/9.22.1/firebase-auth.js";

        // Your web app's Firebase configuration
        const firebaseConfig = {
            apiKey: "AIzaSyCZ4dh48OkEXvidRb6GqmxLKw-GcBtUuH8",
            authDomain: "data-storing123.firebaseapp.com",
            projectId: "data-storing123",
            storageBucket: "data-storing123.firebasestorage.app",
            messagingSenderId: "611424926316",
            appId: "1:611424926316:web:bc17f07fd0c2fcccfb3649"
        };

        // Initialize Firebase
        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);

        // Make auth and firebase available globally
        window.firebaseAuth = {
            auth: auth,
            createUser: createUserWithEmailAndPassword,
            signIn: signInWithEmailAndPassword,
            sendEmailVerification: sendEmailVerification,
            sendPasswordReset: sendPasswordResetEmail,
            confirmPasswordReset: confirmPasswordReset,
            signOut: signOut,
            onAuthStateChanged: onAuthStateChanged,
            setPersistence: setPersistence,
            updateProfile: updateProfile,
            persistenceLocal: browserLocalPersistence,
            persistenceSession: browserSessionPersistence
        };

        // Check authentication state on page load
        onAuthStateChanged(auth, (user) => {
            if (user) {
                console.log("User is signed in");
                // You might want to add logic here to redirect to dashboard if on login/signup page
            } else {
                console.log("No user signed in");
                // You might want to add logic here to redirect to login if on protected pages
            }
        });
    </script>

    <!-- Additional sidebar fix script -->
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Force proper styling for sidebar elements
            function fixSidebarStyling() {
                // Target all possible sidebar elements
                const sidebarElements = document.querySelectorAll('.sidebar, .sidebar *');

                sidebarElements.forEach(element => {
                    if (element.classList.contains('sidebar')) {
                        element.style.backgroundColor = '#1F2937';
                        element.style.color = 'white';
                    }

                    // Specific styling for different elements
                    if (element.tagName === 'A' ||
                        element.classList.contains('nav-link') ||
                        element.classList.contains('nav-item')) {
                        element.style.color = '#D1D5DB';
                    }

                    if (element.tagName === 'I' ||
                        element.classList.contains('fa') ||
                        element.classList.contains('fas')) {
                        if (element.parentElement &&
                            (element.parentElement.classList.contains('sidebar-header') ||
                             element.parentElement.classList.contains('sidebar'))) {
                            element.style.color = 'white';
                        } else {
                            element.style.color = '#D1D5DB';
                        }
                    }
                });
            }

            // Run immediately
            fixSidebarStyling();

            // Also run after a slight delay to ensure all elements are loaded
            setTimeout(fixSidebarStyling, 500);
        });
    </script>

    {% block scripts %}{% endblock %}
</body>
</html>